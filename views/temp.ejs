<!-- likes -->


/* The Universal Selector */
*, /* All elements*/
*::before, /* All ::before pseudo-elements */
*::after {
  /* All ::after pseudo-elements */
  /* height & width will now include border & padding by default but can be overridden as needed */
  box-sizing: inherit;
}
<div class="rating-selected">
  <form method="PATCH" action="/posts/<%= post._id %>/likes/<%= likes._id%>">
    <button id="like-button"><span class="post-rating-button material-icons-outlined">favorite</span></button>
    <span class="show-likes"><%= post.likes.length %></span>
  </form>
</div>


// function index(req, res) {
  //   Post.find({})
  //   .populate('author')
  //   .then(posts => {
  //     res.render('posts/index', {
  //       title: 'Community Posts',
  //       posts: posts
  //     })
  //   })
  //   .catch(err => {
  //     console.log(err)
  //     res.redirect('/')
  //   })
  // }

  function index(req, res) {
    if (req.query.type === "puppy") {
      Post.find({stage: "Puppy"})
      .then(posts => {
        res.render('posts/index', {
          title: 'Puppy Posts',
          posts 
        })
      })
      .catch(err => {
        console.log(err)
        res.redirect('/')
      })
    } else {
      Post.find({})
      .populate('author')
      .then(posts => {
        res.render('posts/index', {
          title: 'All Posts',
          posts: posts
        })
      })
      .catch(err => {
        console.log(err)
        res.redirect('/')
      })
    }
  }

<% if (post.comments.length) { %>
  <h4>Comments</h4>
  <ul>
    <% post.comments.forEach(comment => { %>
      <li>
        <%= comment.content %> - 
        <img 
          class="avatar" 
          src="<%= comment.author.avatar %>" 
          alt="comment author avatar"
        >
        <%= comment.author.name %> 
      </li>
    <% }) %>
  </ul>
<% } else { %>
  <h4>No comments yet ü§ç</h4>
<% } %>


<!-- sidebar -->
<% if (!user) { %>
  <script defer src="https://accounts.google.com/gsi/client"></script>
<% } %>
</head>
<body>
<div class="sidebar">
  <% if (user) { %>
    <img id="avatar" src="<%= user.profile.avatar %>"/>
    <p>Welcome <%= user.profile.name %>!</p>
      <ul>
        <li>
          <a href="#" class="logo">
          <i class="fas fa-solid fa-duotone fa-2x fa-paw"></i>
          <span class="nav-item">PawMily Album</span>
          </a>
        </li>
        <li>
          <a href="/auth/logout" class="right">
          <button type="logout-btn">Logout</button>
          </a>
        </li>
        <li>
          <a href="/profiles/<%= user.profile._id %>">
          <i class="fas fa-solid fa-house"></i>
          <span class="nav-item">My Album</span>
          </a>
        </li>
        <li>
          <a class="dropdown" href="/posts/">
          <i class="fas fa-solid fa-square-caret-down"></i>
          <label for="stage">Explore</label>
          <div class="nav-item" name="stage" id="stage">
            <a href="#">Puppy</a>
            <a href="#">Adult</a>
            <a href="#">Sage</a>
          </div>
          </a>
        </li>
        <li>
          <a href="/posts/new">
          <i class="fas fa-solid fa-flie-pen"></i>
          <span class="nav-item">New Post</span>
        </a>
        </li>
      </ul>
  <% } else { %>
    <div 
      id="g_id_onload"
      data-client_id="<%= googleClientID %>"
      data-login_uri="/auth/google"
      data-auto_prompt="false"
      data-prompt_parent_id="g_id_onload"
    ></div>
    <div 
      class="g_id_signin right"
      data-type="standard"
      data-size="large"
      data-theme="outline"
      data-text="sign_in_with"
      data-shape="rectangular"
      data-logo_alignment="left"
    ></div>
  <% } %>
</div>

function index(req, res) {
  Post.find{}
  .populate('author')
  .then(posts => {
    if (req.query.type === "puppy") {
      Post.find({stage: "Puppy"})
    }
    res.render('posts/index', {
      title: 'All Posts',
      posts: posts
    })
  })
  .catch(err => {
    console.log(err)
    res.redirect('/')
  })
}

// function addLike(req, res) {
  //   Post.findById(req.params.postId)
  //   .then(post => {
  //     post.likes.push(req.user.profile._id)
  //     post.save()
  //     res.redirect(`/posts/${post._id}`)
  //   })
  //   .catch(err => {
  //     console.log(err)
  //     res.redirect('/')
  //   })
  // }
  
  function addLike(req, res) {
    try {
      Post.findByIdAndUpdate(req.params.postId,
      { $push: { likes: req.user.profile }},
      )
  
    } catch (error) {
  
    }
  }
  
  router.post('/:postId/likes', isLoggedIn, postsCtrl.addLike)

  .like-button {
    margin-right: 6px;
    cursor: pointer;
    color: rgb(165, 147, 147);
  }
  .like-button > .show-likes{
    color: rgba(255, 0, 0, 0.461)
  }

  <button id="like-button"><span class="post-rating-button material-icons-outlined">ü§ç</span></button>
            <h4><%= post.likes.length %></h4>